<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Submission PDF</title>
<style>
  body { font-family: DejaVu Sans, Arial, sans-serif; font-size: 12px; color: #111; }
  h1 { font-size: 20px; margin: 0 0 12px; }
  h2 { font-size: 16px; margin: 18px 0 8px; }
  .section { border: 1px solid #999; padding: 10px; margin-bottom: 10px; }
  .row { display: flex; flex-wrap: wrap; }
  .col { width: 50%; box-sizing: border-box; padding-right: 10px; }
  .label { color: #555; font-weight: bold; }
  .value { margin: 2px 0 8px; }
</style>
</head>
<body>
  {% set f = record.fields or {} %}
  {% set d = record.documents or {} %}

  <h1>Visa Application Submission</h1>
  <div class="section">
    <div class="row">
      <div class="col"><span class="label">Submission ID:</span> <span class="value">{{ record.id }}</span></div>
      <div class="col"><span class="label">Submitted At (UTC):</span> <span class="value">{{ record.meta.submitted_at }}</span></div>
      <div class="col"><span class="label">Case Number:</span> <span class="value">{{ record.meta.case_number }}</span></div>
      <div class="col"><span class="label">Status:</span> <span class="value">{{ record.meta.status }}</span></div>
    </div>
  </div>

  <h2>Personal Information</h2>
  <div class="section">
    <div class="row">
      <div class="col"><div class="label">Full Name</div><div class="value">{{ f.get('full_name') or '-' }}</div></div>
      <div class="col"><div class="label">Passport Number</div><div class="value">{{ f.get('passport_number') or '-' }}</div></div>
      <div class="col"><div class="label">Nationality</div><div class="value">{{ f.get('country_citizenship') or f.get('nationality') or '-' }}</div></div>
      <div class="col"><div class="label">Email</div><div class="value">{{ f.get('email') or f.get('personal_email') or '-' }}</div></div>
      <div class="col"><div class="label">Phone</div><div class="value">{{ f.get('phone') or f.get('usa_phone') or '-' }}</div></div>
      <div class="col"><div class="label">Date of Birth</div><div class="value">{{ f.get('dob') or '-' }}</div></div>
    </div>
  </div>

  <h2>Contact (USA)</h2>
  <div class="section">
    <div class="row">
      <div class="col" style="width:100%"><div class="label">Address Line 1</div><div class="value">{{ f.get('usa_address1') or '-' }}</div></div>
      <div class="col" style="width:100%"><div class="label">Address Line 2</div><div class="value">{{ f.get('usa_address2') or '-' }}</div></div>
      <div class="col"><div class="label">State</div><div class="value">{{ f.get('usa_state') or '-' }}</div></div>
      <div class="col"><div class="label">City</div><div class="value">{{ f.get('usa_city') or '-' }}</div></div>
      <div class="col"><div class="label">ZIP</div><div class="value">{{ f.get('usa_zip') or '-' }}</div></div>
      <div class="col"><div class="label">Contact Number</div><div class="value">{{ f.get('usa_contact_number') or '-' }}</div></div>
      <div class="col" style="width:100%"><div class="label">Email Address</div><div class="value">{{ f.get('usa_email') or '-' }}</div></div>
    </div>
  </div>

  <h2>Contact (Outside USA)</h2>
  <div class="section">
    <div class="row">
      <div class="col" style="width:100%"><div class="label">Address Line 1</div><div class="value">{{ f.get('home_address1') or '-' }}</div></div>
      <div class="col" style="width:100%"><div class="label">Address Line 2</div><div class="value">{{ f.get('home_address2') or '-' }}</div></div>
      <div class="col" style="width:100%"><div class="label">Country</div><div class="value">{{ f.get('home_country') or '-' }}</div></div>
      <div class="col"><div class="label">State</div><div class="value">{{ f.get('home_state') or '-' }}</div></div>
      <div class="col"><div class="label">City</div><div class="value">{{ f.get('home_city') or '-' }}</div></div>
      <div class="col" style="width:100%"><div class="label">Zip/Postal Code</div><div class="value">{{ f.get('home_zip') or '-' }}</div></div>
    </div>
  </div>

  <h2>Sponsoring Employer</h2>
  <div class="section">
    <div class="row">
      <div class="col"><div class="label">Employer</div><div class="value">{{ f.get('sponsoring_employer') or '-' }}</div></div>
      <div class="col"><div class="label">Employer Address</div><div class="value">{{ f.get('sponsoring_employer_address') or '-' }}</div></div>
    </div>
  </div>

  <h2>Education</h2>
  <div class="section">
    {% set all = record.fields or {} %}
    {% set edu = [] %}
    {% for k,v in all.items() %}
      {% if k.startswith('edu[') %}
        {% set _ = edu.append((k,v)) %}
      {% endif %}
    {% endfor %}
    {% if edu|length > 0 %}
      {% for k,v in edu|sort %}
        <div class="value"><span class="label" style="display:inline-block; min-width:200px;">{{ k }}</span> {{ v }}</div>
      {% endfor %}
    {% else %}
      <div class="value">No education entries provided.</div>
    {% endif %}
  </div>

  <h2>Work Experience</h2>
  <div class="section">
    {% set wb = [] %}
    {% for k,v in all.items() %}
      {% if k.startswith('wb[') %}
        {% set _ = wb.append((k,v)) %}
      {% endif %}
    {% endfor %}
    {% if wb|length > 0 %}
      {% for k,v in wb|sort %}
        <div class="value"><span class="label" style="display:inline-block; min-width:200px;">{{ k }}</span> {{ v }}</div>
      {% endfor %}
    {% else %}
      <div class="value">No work entries provided.</div>
    {% endif %}
  </div>

  <h2>Visa History</h2>
  <div class="section">
    {% set visa = [] %}
    {% for k,v in all.items() %}
      {% if k.startswith('visa_') %}
        {% set _ = visa.append((k,v)) %}
      {% endif %}
    {% endfor %}
    {% if visa|length > 0 %}
      {% for k,v in visa|sort %}
        <div class="value"><span class="label" style="display:inline-block; min-width:200px;">{{ k }}</span> {{ v }}</div>
      {% endfor %}
    {% else %}
      <div class="value">No visa history provided.</div>
    {% endif %}
  </div>

  <h2>Other Information</h2>
  <div class="section">
    {% set other = [] %}
    {% for k,v in all.items() %}
      {% if k.startswith('other_') %}
        {% set _ = other.append((k,v)) %}
      {% endif %}
    {% endfor %}
    {% if other|length > 0 %}
      {% for k,v in other|sort %}
        <div class="value"><span class="label" style="display:inline-block; min-width:200px;">{{ k }}</span> {{ v }}</div>
      {% endfor %}
    {% else %}
      <div class="value">No other information provided.</div>
    {% endif %}
  </div>

  <h2>Documents</h2>
  <div class="section">
    {% if d and d|length > 0 %}
      {% for key, files in d.items() %}
        {% if files %}
          <div class="label">{{ key }}</div>
          <div class="value">
            {% for file in (files if files is sequence else [files]) %}
              â€¢ {{ file }}<br/>
            {% endfor %}
          </div>
        {% endif %}
      {% endfor %}
    {% else %}
      <div class="value">No documents uploaded.</div>
    {% endif %}
  </div>
</body>
</html>
